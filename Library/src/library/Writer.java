/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package library;



import DAO.WriterDAO;
import DataHelper.Notify;
import DataHelper.ShareData;
import DataHelper.Validator;
import java.awt.Color;
import java.util.List;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author Acer
 */
public class Writer extends javax.swing.JPanel {
private DefaultTableModel table;
    /**
     * Creates new form Writer
     */
    public Writer() {
        initComponents();
        initTable();
        loadData();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        buttonGroup2 = new javax.swing.ButtonGroup();
        jPanel3 = new javax.swing.JPanel();
        rdnu = new javax.swing.JRadioButton();
        txtday = new javax.swing.JFormattedTextField();
        txtemail = new javax.swing.JFormattedTextField();
        jLabel5 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        rdnam = new javax.swing.JRadioButton();
        txtaddress = new javax.swing.JTextField();
        txtphone = new javax.swing.JTextField();
        txtname = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tablewriter = new javax.swing.JTable();
        btnDel = new javax.swing.JButton();
        btnupdate = new javax.swing.JButton();
        btnsave = new javax.swing.JButton();

        jPanel3.setBackground(new java.awt.Color(204, 204, 255));

        buttonGroup1.add(rdnu);
        rdnu.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        rdnu.setText("Nữ");

        txtday.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        txtemail.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        jLabel5.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        jLabel5.setForeground(new java.awt.Color(0, 51, 204));
        jLabel5.setText("Ngày sinh");

        jLabel7.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        jLabel7.setForeground(new java.awt.Color(0, 51, 204));
        jLabel7.setText("Email");

        jLabel4.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        jLabel4.setForeground(new java.awt.Color(0, 51, 204));
        jLabel4.setText("Giới Tính");

        buttonGroup1.add(rdnam);
        rdnam.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        rdnam.setSelected(true);
        rdnam.setText("Nam");

        txtaddress.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        txtphone.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        txtname.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        jLabel1.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(0, 51, 204));
        jLabel1.setText("Họ Tên");

        jLabel2.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(0, 51, 204));
        jLabel2.setText("Số Điện Thoại");

        jLabel3.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(0, 51, 204));
        jLabel3.setText("Địa Chỉ");

        tablewriter.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        tablewriter.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tablewriterMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(tablewriter);

        btnDel.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        btnDel.setForeground(new java.awt.Color(255, 0, 0));
        btnDel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Image/delete.png"))); // NOI18N
        btnDel.setText("Xóa");
        btnDel.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        btnDel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnDelActionPerformed(evt);
            }
        });

        btnupdate.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        btnupdate.setForeground(new java.awt.Color(255, 102, 0));
        btnupdate.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Image/update.png"))); // NOI18N
        btnupdate.setText("Sửa");
        btnupdate.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        btnupdate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnupdateActionPerformed(evt);
            }
        });

        btnsave.setFont(new java.awt.Font("Segoe UI", 1, 12)); // NOI18N
        btnsave.setForeground(new java.awt.Color(255, 0, 102));
        btnsave.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Image/them.png"))); // NOI18N
        btnsave.setText("Thêm");
        btnsave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnsaveActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane1)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel3)
                            .addComponent(jLabel2)
                            .addComponent(jLabel1))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtname, javax.swing.GroupLayout.PREFERRED_SIZE, 145, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txtphone, javax.swing.GroupLayout.PREFERRED_SIZE, 145, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txtaddress, javax.swing.GroupLayout.PREFERRED_SIZE, 145, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(50, 50, 50)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jLabel5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jLabel7)
                            .addComponent(jLabel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel3Layout.createSequentialGroup()
                                .addComponent(rdnam)
                                .addGap(18, 18, 18)
                                .addComponent(rdnu))
                            .addComponent(txtemail, javax.swing.GroupLayout.PREFERRED_SIZE, 117, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txtday, javax.swing.GroupLayout.PREFERRED_SIZE, 117, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(btnsave, javax.swing.GroupLayout.PREFERRED_SIZE, 89, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(btnupdate)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(btnDel)))
                .addContainerGap(245, Short.MAX_VALUE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(txtname, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtemail, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel7))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel2)
                    .addComponent(txtphone, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtday, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel5))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel4)
                        .addComponent(rdnam)
                        .addComponent(rdnu))
                    .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel3)
                        .addComponent(txtaddress, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(20, 20, 20)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnsave)
                    .addComponent(btnupdate)
                    .addComponent(btnDel))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 271, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
    }// </editor-fold>//GEN-END:initComponents

    private void btnsaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnsaveActionPerformed
        // TODO add your handling code here:
        StringBuilder sb=new StringBuilder();
        Validator.CheckText(txtname, sb, "Tên nhà văn null");
        Validator.CheckText(txtemail, sb, "Email null");
        Validator.CheckText(txtday, sb, "Ngày sinh null");
        Validator.CheckText(txtphone, sb, "Số điện thoại null");
        Validator.CheckText(txtaddress, sb, "Địa chỉ null");
         if(sb.length()>0)
            {
                Notify.ChickenMessageDialog(this, sb.toString(), "Lỗi");
                return;
            }
        try {
         Model.Writer s=new Model.Writer();
          s.setName(txtname.getText());
          s.setEmail(txtemail.getText());
          
          s.setNgaysinh(txtday.getText());
          s.setPhone(txtphone.getText());
          s.setAddress(txtaddress.getText());
          s.setSex(rdnam.isSelected()?"Nam":"Nữ");
          
          WriterDAO st=new WriterDAO();
          if(st.insertWriter(s))
          {
              Notify.ChickenMessageDialog(this, "Thêm nhà văn thành công", "Thông báo");
              loadData();
          }
          else{
              Notify.ChickenErrorMessageDialog(this, "Đã xảy ra lỗi vui lòng xem lại", "Cảnh báo");
          }
        } catch (Exception e) {
            e.printStackTrace();//in ra chi tiết lỗi
            Notify.ChickenErrorMessageDialog(this, e.getMessage(), "Lỗi");
        }
    }//GEN-LAST:event_btnsaveActionPerformed
private static String id;
    private void tablewriterMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tablewriterMouseClicked
        // TODO add your handling code here:
         int select=tablewriter.getSelectedRow();
        id=tablewriter.getValueAt(select, 0).toString();
        try {
            WriterDAO d=new WriterDAO();
             Model.Writer w = d.FinById(id);
            txtname.setText(w.getName());
            txtphone.setText(w.getPhone());
            txtemail.setText(w.getEmail());
            txtaddress.setText(w.getAddress());
            txtday.setText(w.getNgaysinh());
        if(w.getSex().equalsIgnoreCase("Nam"))
        {
            rdnam.setSelected(true);
            rdnu.setSelected(false);
        }
        else
        {
            rdnu.setSelected(true);
            rdnam.setSelected(false);
        }
        } catch (Exception e) {
        }
        
    }//GEN-LAST:event_tablewriterMouseClicked

    private void btnupdateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnupdateActionPerformed
        // TODO add your handling code here:
             // TODO add your handling code here:
        StringBuilder sb=new StringBuilder();
        Validator.CheckText(txtname, sb, "Tên nhà văn null");
        Validator.CheckText(txtemail, sb, "Email null");
        Validator.CheckText(txtday, sb, "Ngày sinh null");
        Validator.CheckText(txtphone, sb, "Số điện thoại null");
        Validator.CheckText(txtaddress, sb, "Địa chỉ null");
         if(sb.length()>0)
            {
                Notify.ChickenMessageDialog(this, sb.toString(), "Lỗi");
                return;
            }
         if(Notify.ChickenConfirmDialog(this, "Bạn có muốn cập nhập không?", "Thông báo")==JOptionPane.NO_OPTION)
         {
             return;
         }
        try {
          
          Model.Writer up=new Model.Writer();
          up.setId(id);
          up.setName(txtname.getText());
          up.setSex(rdnam.isSelected()?"Nam":"Nữ");
          up.setNgaysinh(txtday.getText());
           up.setPhone(txtphone.getText());
          up.setEmail(txtemail.getText());
          up.setAddress(txtaddress.getText());
          WriterDAO st=new WriterDAO();
          if(st.updateWriter(up))
          {
              Notify.ChickenMessageDialog(this, "Cập nhập dữ liệu thành công", "Thông báo");
              loadData();
          }
          else{
              Notify.ChickenErrorMessageDialog(this, "Đã xảy ra lỗi vui lòng xem lại", "Cảnh báo");
          }
        } catch (Exception e) {
            e.printStackTrace();//in ra chi tiết lỗi
            Notify.ChickenErrorMessageDialog(this, e.getMessage(), "Lỗi");
        }
    }//GEN-LAST:event_btnupdateActionPerformed

    private void btnDelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnDelActionPerformed
        // TODO add your handling code here:
        StringBuilder sb=new StringBuilder();
        if(id==null)
        {
            sb.append("Chưa chọn nhà văn để xóa");
            
        }
        if(sb.length()>0)
        {
            Notify.ChickenMessageDialog(this, sb.toString(), "Báo lỗi");
            return;
        }
        if(Notify.ChickenConfirmDialog(this, "Bạn có muốn xóa nhà văn không?", "Thông báo")==JOptionPane.NO_OPTION)
         {
             return;
         }
        try {
            WriterDAO sf=new WriterDAO();
            Model.Writer s=new Model.Writer();
            s.setId(id);
            if(sf.deleteWriter(s))
            {
                Notify.ChickenMessageDialog(this, "Xóa dữ liệu có mã "+id+" thành công", "Thông báo");
                loadData();
            }
            else{
                Notify.ChickenMessageDialog(this, "Không có mã "+id+" trong CSDL", "Báo lỗi");
            }
        } catch (Exception e) {
            Notify.ChickenErrorMessageDialog(this, e.getMessage(), "Lỗi");
        }
    }//GEN-LAST:event_btnDelActionPerformed
private void initTable()
    {
        table=new DefaultTableModel();
        table.setColumnIdentifiers(new String[]{"Mã nhà văn","Tên nhà văn","Giới tính","Ngày sinh","Số điện thoại","Email","Địa chỉ"});//set danh sách cột trong table
        tablewriter.setModel(table);
    }
    public void loadData()
    {
        try {
            WriterDAO sf=new WriterDAO();
            List<Model.Writer> list=sf.FindWriter();
            table.setRowCount(0);//trc khi cap nhâp xoa hết data r update lại
            for(Model.Writer s:list)
            {
                table.addRow(new Object[]{
                    s.getId(),s.getName(),s.getSex(),s.getNgaysinh(),s.getPhone(),s.getEmail(),s.getAddress()
                });
            }
            table.fireTableDataChanged();//cập nhập hiển thị dữ liệu
        } catch (Exception e) {
        }
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnDel;
    private javax.swing.JButton btnsave;
    private javax.swing.JButton btnupdate;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.ButtonGroup buttonGroup2;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JRadioButton rdnam;
    private javax.swing.JRadioButton rdnu;
    private javax.swing.JTable tablewriter;
    private javax.swing.JTextField txtaddress;
    private javax.swing.JFormattedTextField txtday;
    private javax.swing.JFormattedTextField txtemail;
    private javax.swing.JTextField txtname;
    private javax.swing.JTextField txtphone;
    // End of variables declaration//GEN-END:variables
}
